# 실행 컨텍스트

실행 컨텍스트를 설명하기 전 스코프 개념에 대해서 간단히 알아보자.

동적 스코프

# 실행 컨텍스트

## 실행 컨텍스트란 자바스크립트가 왜 그렇게 동작하는지 알려준다.

실행 컨텍스트를 제대로 알기 위해서는 Scope를 알아야 한다.

[Scope에 대한 글 바로가기](./scope.md)

### 컨텍스트

컨텍스트란 실행환경으로 두가지로 나뉜다.

- 종류

  - 전역 컨텍스트

    - 모든 것을 관리하는 환경으로 브라우저가 스크립트를 로딩해서 실행하는 순간 생긴다.
    - 페이지가 종료될 때 까지 유지된다.

  - 함수 컨텍스트

    - 함수를 호출할 때마다 생긴다.

- 원칙

  1. 먼저 전역 컨텍스트 하나 생성 후, 함수 호출 시마다 컨텍스트가 생깁니다.
  2. 컨텍스트 생성 시 컨텍스트 안에 **변수객체(arguments, variable), scope chain, this**가 생성됩니다.
  3. 컨텍스트 생성 후 함수가 실행되는데, 사용되는 변수들은 변수 객체 안에서 값을 찾고, 없다면 스코프 체인을 따라 올라가며 찾습니다.
  4. 함수 실행이 마무리되면 해당 컨텍스트는 사라집니다.(클로저 제외) 페이지가 종료되면 전역 컨텍스트가 사라집니다.

- 실행

  ```js
  var name = "zero"; // (1)변수 선언 (6)변수 대입
  function wow(word) {
    // (2)변수 선언 (3)변수 대입
    console.log(word + " " + name); // (11)
  }
  function say() {
    // (4)변수 선언 (5)변수 대입
    var name = "nero"; // (8)
    console.log(name); // (9)
    wow("hello"); // (10)
  }
  say(); // (7)
  ```

  - 전역 컨텍스트

    ```js
    '전역 컨텍스트': {
    변수객체: {
        arguments: null,
        variable: ['name', 'wow', 'say'],
    },
    scopeChain: ['전역 변수객체'],
    this: window,
    }
    ```

    위의 코드를 객체 형식으로 표현하였다.

    **호이스팅** 으로 인해 `wow`와 `say`은 선언과 동시에 대입이 이루어진다.

    이후에 `name`에 'zero'가 대입된다.

  - ## 함수 컨텍스트

    ```js
    'say 컨텍스트': {
      변수객체: {
        arguments: null,
        variable: ['name'], // 초기화 후 [{ name: 'nero' }]가 됨
      },
      scopeChain: ['say 변수객체', '전역 변수객체'],
      this: window,
    }
    ```

    `say` 호출 후에 위에서부터 차례대로 실행한다.

    (8) : `variable`의 `name`에 'nero'를 대입한다.

    (9) : `say` 컨텍스트 안의 `name`을 출력한다.

    (10) : `wow` 함수는 `say` 컨텍스트에서 찾을 수가 없다. => Scope Chain을 따라 상위 변수객체인 전역 변수객체에서 `variable`의 `wow` 함수를 호출한다.

    ```js
    'wow 컨텍스트': {
      변수객체: {
        arguments: [{ word : 'hello' }],
        variable: null,
      },
      scopeChain: ['wow 변수객체', '전역 변수객체'],
      this: window,
    }
    ```

    여기서 제일 중요한 점은 `say` 함수 안에서 `wow` 함수가 호출되었다고 `scopechain`에 `say` 변수객체가 들어가는 것이 절대 아니다.

    정적 스코프답게 자기 자신인 `wow` 변수객체와 **전역 변수객체**가 들어간다.

    (10) : `wow`는 `arguments`에서 찾고, `name`은 `scopechain`을 따라 전역 변수객체에서 찾는다.

    따라서 'hello nero'가 아닌 'hello zero'가 콘솔에 찍힌다.

    `wow` 함수 종료 후 `wow`컨텍스트가 사라지고, `sys`함수의 실행이 마무리된다.

    `say` 함수 종료후 `say`컨텍스트가 사라지고, 마지막으로 전역 컨텍스트도 사라진다.

  ### **이렇게 모든 것이 논리적인 실행 컨텍스트 개념을 이해하는 것은 자바스크립트 전반을 이해하는데 매우 중요하다.**

## 참고자료

https://www.zerocho.com/category/JavaScript/post/5741d96d094da4986bc950a0
